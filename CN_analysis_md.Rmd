---
output:
  html_document:
    number_sections: false
---
```{r banner,,echo=FALSE}
# knitr::include_graphics(c("RESAS_logo_mg.jpg"),("Scottish_Government_logo_RGB.jpg"))

```

```{r title, include=F}
title <- title_var
```
---
title: `r title_var`
---
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(kableExtra)
library(cowplot)
library(magick)
options(scipen=999)
options(knitr.kable.NA = '--')
```


```{r all_plots, echo=FALSE, message=FALSE, fig.width=10}
for(i in Output_types){
output_plot <- function(quantity_label, y_label){
  output_plot <- ggplot(filter(Master_plots, `Farm type`==fbs_type_words[i], Quantity == quantity_label)) +
    geom_col(aes(x=`Year`, y=Median), fill="#23A845") +
    geom_point(aes(x=`Year`, y=Median)) +
    geom_errorbar(aes(x=`Year`, ymin=Q1, ymax = Q3, width=0.25)) +
    geom_hline(yintercept = 0,colour="grey90")+
    xlab(element_blank())+
    # facet_wrap(vars(facet_order), scales="free") +
    # scale_x_discrete(guide = guide_axis(n.dodge=3))+
    ylab(bquote(.(y_label)))
  return(output_plot)
}
# Use the above function to create four plots, and then arrange in a grid.
g_co2perha <- output_plot("t CO2-e per ha", "t CO"[2]~"-e / ha")
g_co2perkg <- output_plot("kg CO2-e per kg output", "kg CO"[2]~"-e / kg output")
g_Nsurplus <- output_plot("Nitrogen surplus (kg)", "kg N surplus / ha")
g_NUE <- output_plot("Nitrogen use efficiency (%)", "NUE (%)")
g_grid <- grid.arrange(g_co2perha, g_co2perkg, g_Nsurplus, g_NUE,
                       top=textGrob(fbs_type_words[i],gp=gpar(fontsize=20,font=2),x=0,hjust=0))
}

```

```{r test}
for (i in Output_types){
output_plot <- function(quantity_label, y_label){
  output_plot <- ggplot(filter(Master_plots, `Farm type`==fbs_type_words[i], Quantity == quantity_label)) +
    geom_col(aes(x=`Year`, y=Median), fill="#23A845") +
    geom_point(aes(x=`Year`, y=Median)) +
    geom_errorbar(aes(x=`Year`, ymin=Q1, ymax = Q3, width=0.25)) +
    geom_hline(yintercept = 0,colour="grey90")+
    xlab(element_blank())+
    # facet_wrap(vars(facet_order), scales="free") +
    # scale_x_discrete(guide = guide_axis(n.dodge=3))+
    ylab(bquote(.(y_label)))
  return(output_plot)
}
# Use the above function to create four plots, and then arrange in a grid.
g_co2perha <- output_plot("t CO2-e per ha", "t CO"[2]~"-e / ha")
g_co2perkg <- output_plot("kg CO2-e per kg output", "kg CO"[2]~"-e / kg output")
g_Nsurplus <- output_plot("Nitrogen surplus (kg)", "kg N surplus / ha")
g_NUE <- output_plot("Nitrogen use efficiency (%)", "NUE (%)")
g_grid <- grid.arrange(g_co2perha, g_co2perkg, g_Nsurplus, g_NUE,
                       top=textGrob(fbs_type_words[i],gp=gpar(fontsize=20,font=2),x=0,hjust=0))
}
```

[1] All farm types includes lowland cattle and sheep farms.


![](RESAS_logo_mg.jpg){width="7.8cm" style="float:left"}![](Scottish_Government_logo_RGB.jpg){width=7.3cm style="float:right; padding-top:0.4cm"}



