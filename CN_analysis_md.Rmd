---
output:
  html_document:
    number_sections: false
---

```{r title, include=FALSE}
title <- title_var
```

<!-- Need the pipes in the next code chunk in order to cope with a colon in the title and to place the title on a separate line from the images -->
<!-- The ![](){} syntax is used for inserting images.  -->
<!-- Anything in the square brackets becomes the caption (here blank). -->
<!-- The round brackets specify the image filepath. -->
<!-- The curly brackets are for image formatting (here width and positioning) -->
<!-- A space is also needed immediately after this line, and before the "---". -->

---
title: | 
  | ![](RESAS_logo_mg.jpg){width="7.8cm" style="float: left"}![](Scottish_Government_logo_RGB.jpg){width=7.3cm style="float: right; padding-top: 0.4cm"}
  | <!-- A space is needed here to prevent pipes appearing in the title. -->
  | `r paste0(title_var)`
---

  
# Summary
Summary text could go here?

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(kableExtra)
library(cowplot)
library(magick)
options(scipen=999)
options(knitr.kable.NA = '--')
```

```{r all_plots, echo=FALSE, message=FALSE, fig.width=10}
for (i in Output_types) {

  # Use the output_plot function to create four plots, and then arrange in a grid.
  # Input arguments are type, title, quantity and y-axis label
  g_co2perha <- output_plot(i, "Absolute emissions", "t CO2-e per ha", "t CO"[2]~"-e / ha", "#23A845")
  g_co2perkg <- output_plot(i, "Emission intensity", "kg CO2-e per kg output", "kg CO"[2]~"-e / kg output", "#23A845")
  g_Nsurplus <- output_plot(i, "Nitrogen balance", "Nitrogen surplus (kg)", "kg N surplus / ha", "#80BA27")
  g_NUE <- output_plot(i, "Nitrogen use efficiency", "Nitrogen use efficiency (%)", "NUE (%)", "#80BA27")
  if(i==9){
    farmtype_title <- "All farm types"
  } else{
    farmtype_title <- fbs_type_words[i]
  }
  g_grid <- grid.arrange(g_co2perha, g_co2perkg, g_Nsurplus, g_NUE,
                         top=textGrob(farmtype_title,gp=gpar(fontsize=20,font=2),x=0,hjust=0))
  
  ## Next two lines used to create charts with no farmtype-titles, for dropping into powerpoint.
  # g_grid_no_typetitle <- grid.arrange(g_co2perha, g_co2perkg, g_Nsurplus, g_NUE)
  # ggsave(file=paste0(Output_directory,"/Charts/Farm Business Survey ", max(sampyear_range)-1,"-",max(sampyear_range)-2000," - Carbon and Nitrogen charts - ",fbs_type_words[i],".png"), plot=g_grid_no_typetitle, height=6,width=10)
}
```

<!-- [1] All farm types includes lowland cattle and sheep farms. -->

![](RESAS_logo_mg.jpg){width="7.8cm" style="float: left"}![](Scottish_Government_logo_RGB.jpg){width=7.3cm style="float: right; padding-top: 0.4cm"}

